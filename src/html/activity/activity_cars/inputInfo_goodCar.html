<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport'
          content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui'>
    <meta name='apple-mobile-web-app-capable' content='yes'>
    <meta name='apple-mobile-web-app-status-bar-style' content='black'>

    <title>中华好车</title>
    <style>
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none !important;
            margin: 0;
        }

        input[type='number'] {
            -moz-appearance: textfield;
        }

        body {
            font-family: 'Microsoft YaHei', 'Hiragino Sans GB', Helvetica, Arial, 'Lucida Grande', sans-serif;
            width: 3.2rem;
            margin: 0 auto;
            padding: 0;
            background-color: #f6f4f4;
        }

        ol, ul {
            list-style: none;
            padding: 0;
            margin: 0;
            border-bottom: 1px solid #d4d4d4;
            border-top: 1px solid #d4d4d4;
            background-color: #ffffff;
        }

        a {
            text-decoration: none;
            outline: none;
            color: #515151;
        }

        a:hover {
            text-decoration: none;
        }

        .col-20 {
            width: 19.9%;
            float: left;
        }

        input {
            border: 0 none;
            font-size: 0.12rem;
            outline: none;
            color: #888;
        }

        .text_width {
            width: 14.9%;
            float: left;
        }

        .text_plate_width {
            width: 14.9%;
            float: left;
        }

        .input_plate_width {
            width: 29.9%;
            float: left;
        }

        .input_info_width {
            width: 52.9%;
            float: left;
        }

        ul#ul_info.info_complete input {
            color: #FB4C0F;
            background-color: white;
        }

        .li_info {
            padding-left: 0.05rem;
            margin-left: 0.05rem;
            list-style-type: none;
            height: 0.45rem;
            line-height: 0.45rem;
            font-size: 0.12rem;
            border-bottom: 1px solid #d4d4d4;
            clear: both;
        }

        li.no_line {
            border: 0 solid #d4d4d4;
        }

        .clear {
            clear: both;
        }

        .enter_btn {
            height: 0.4rem;
            line-height: 0.4rem;
            background-color: rgb(251, 76, 15);
            color: #ffffff;
            text-align: center;
            font-size: 0.175rem;
            border-radius: 0.05rem;
            border-style: hidden;
            outline: none;
            margin: 0 0.19rem;
            margin-top: 0.2rem;
        }

        .new_car {
            width: 0.5rem;
            margin-left: 6px;
        }

        .new_car img {
            float: right;
            padding-top: 0.125rem;
            width: 0.2rem;
            height: 0.2rem;
            clear: both;
        }

        .insure_div {
            width: 30.9%;
            float: left;
            text-align: right;
        }

        .insure_btn {
            width: 0.8rem;
            text-align: center;
            color: #ffffff;
            border-radius: 0.03rem;
            background-color: #FB4C0F;
            font-size: 0.1rem;
            border-style: hidden;
            outline: none;
            margin-right: 15px;
            padding-top: 0.07rem;
            padding-bottom: 0.07rem;
        }

        .disable {
            background-color: #ccc;
        }

        input.disable {
            background-color: #fff;
        }

        form {
            display: none;
        }

        .hide {
            display: none;
        }

        label:focus {
            background-color: #fff;
        }

        input.plate_width {
            width: 100%;
        }

        @media (device-width: 320px ) and (device-height: 568px) and (-webkit-min-device-pixel-ratio: 2 ) {
            /* 兼容iphone5 */
            ol, ul {
                list-style: none;
                padding: 0;
                margin: 0;
                border-bottom: 0.5px solid #d4d4d4;
                border-top: 0.5px solid #d4d4d4;
                background-color: #ffffff;
            }

            .li_info {
                list-style-type: none;
                height: 0.45rem;
                line-height: 0.45rem;
                font-size: 0.12rem;
                border-bottom: 0.5px solid #d4d4d4;
                clear: both;
            }

        }

        @media (device-width: 375px ) and (device-height: 667px) and (-webkit-min-device-pixel-ratio: 2 ) {
            /* 兼容iphone6 */
            ol, ul {
                list-style: none;
                padding: 0;
                margin: 0;
                border-bottom: 0.5px solid #d4d4d4;
                border-top: 0.5px solid #d4d4d4;
                background-color: #ffffff;
            }

            .li_info {
                list-style-type: none;
                height: 0.45rem;
                line-height: 0.45rem;
                font-size: 0.12rem;
                border-bottom: 0.5px solid #d4d4d4;
                clear: both;
            }

        }

        @media (device-width: 414px ) and (device-height: 736px) and (-webkit-min-device-pixel-ratio: 2 ) {
            /* 兼容iphone6 Plus */
            ol, ul {
                list-style: none;
                padding: 0;
                margin: 0;
                border-bottom: 0.5px solid #d4d4d4;
                border-top: 0.5px solid #d4d4d4;
                background-color: #ffffff;
            }

            .li_info {
                list-style-type: none;
                height: 0.45rem;
                line-height: 0.45rem;
                font-size: 0.12rem;
                border-bottom: 0.5px solid #d4d4d4;
                clear: both;
            }

        }

    </style>
</head>
<body class="hide">
<ul id="ul_info" style="  margin-top: 0.1rem">
    <li class='li_info'>
        <div class='text_width'>姓&emsp;名</div>
        <div class='input_info_width' id='name_div'>
            <input type='text' id='name' oninput="judge(this)" name='name' placeholder='请输入姓名'></div>

    </li>
    <li class='li_info'>
        <div class='text_width'>手机号</div>
        <div class='input_info_width' id='mobile_div'>
            <input type='number' name='mobile' oninput="judge(this)" maxlength='11' onblur="inputBlur(this)" id='mobile'
                   placeholder='请输入手机号'>
        </div>
        <div class='insure_div' style='text-align: right'>
            <button id='get_code' class='insure_btn disable' onblur="inputBlur(this)"
                    onclick='sendCode(this);return false;'>
                获取验证码
            </button>
        </div>
    </li>
    <li class='li_info' id="checkCode">
        <div class='text_width'>验证码</div>
        <div class='input_info_width' id='sendActiveCode_div'>
            <input type='number' id='sendActiveCode' oninput="judge(this)" placeholder='请输入验证码'></div>
    </li>
    <li class="li_info no_line" id="li_plate0">
        <div class="text_plate_width">车牌号</div>
        <div class="input_plate_width" id="plate_div">
            <input class="plate_width" type="text" maxlength="7" id="plateNumber0" onblur="inputBlur(this)"
                   oninput="judge(this)" placeholder="请输入车牌号">
        </div>
        <div id="new_car_div0" class="col-20" style="float: right;">
            <div class="new_car clear" style="float: right; margin-right: 30px">
                <label>新车
                    <img src="../../../images/cars/unchecked.png">
                    <input style="display: none" type="checkbox" onchange="checkNewCar(this)" id="isNewCar0">
                </label>
            </div>
        </div>
    </li>
</ul>

<div class="clear"></div>

<div class='enter_btn' onclick='submitForm()'>投保</div>
<!--<div style="text-align:center;margin-left: auto;margin-right: auto;margin-top: 0.1rem; font-size: 0.09rem;color: darkgrey"><span-->
<!--style="color: #FB4C0F">*</span>以上车险须为同一投保人，且投保人与车主为同一家庭成员-->
<!--</div>-->
<div style="text-align:center;margin-left: auto;margin-right: auto; margin-top:0.1rem;font-size: 0.09rem;color: darkgrey"><span
        style="color: #FB4C0F">*</span>新疆、西藏、青海、宁夏、贵州、海南等六省暂不支持购买
</div>

<!--<div id="statement"-->
<!--style="text-align:center;position: absolute;width:222px; left: 50%; margin-left:-111px; bottom:1%;font-size: 6px;color: darkgrey">-->
<!--万联电子商务股份有限公司在法律允许的范围内对“多车之家”品牌拥有最终解释权-->
<!--</div>-->

<form id='infoForm' action='http://220.171.28.152:9080/wap/portal.do?url=bEB6seMvFCsE05AKeigj8A==' method='post'></form>
</body>

<script src='../../../js/common.js'></script>
<script src='../../../js/jquery-1.9.1.min.js'></script>
<script src='../../../js/jweixin-1.0.0.js'></script>
<script src='../../../js/spinner.js'></script>

<script type='text/javascript'>
    var myData = undefined;
    var isCheckMobile = false;
    var uuid = "";
    var clock;
    var saveNumber = 0;
    var openId = window.localStorage.getItem(config.openIdName);
    var isFocus = false;
    $(function () {
        $('#infoForm').attr('action', config.activity.goodCarUrl);//表单提交地址
        $("#sendActiveCode").val('');
        if (!$.trim($('#mobile').val()).match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)) {
            $("#get_code").addClass("disable");
        } else {
            $("#get_code").removeClass("disable");
        }

        autoWidth();
        $('body').removeClass('hide');

    });


    function judge() {
        var name = $.trim($('#name').val());
        var mobile = $.trim($('#mobile').val());
        var code = $.trim($("#sendActiveCode").val());
        var enable = true;
        if (name == '' || name.length == 0) {
            enable &= false;
        } else {
            enable &= true;
        }
        if (!mobile.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)) {
            enable &= false;
            $("#get_code").addClass("disable");
        } else {
            enable &= true;
            $("#get_code").removeClass("disable");
        }
        if (!isCheckMobile) {
            if (code == '' || code.length == 0) {
                enable &= false;
            } else {
                enable &= true;
            }
        }
        var plateNumber = $.trim($('#plateNumber0').val());
        var isNewCar = $('#isNewCar0').attr("checked") == "checked" ? 1 : 0;
        if (isNewCar == 1 && enable) {
            $('.enter_btn').removeClass('disable');
        } else if (plateNumber.length != 0 && enable && plateNumber.match(/^[\u4e00-\u9fa5]{1}[A-Z_a-z]{1}[A-Z_a-z_0-9]{5}$/)) {
//            $('.enter_btn').removeClass('disable');
        }
        else {
//            $('.enter_btn').addClass('disable');
        }
    }

    function sendCode(btn) {
        var mobile = $.trim($("#mobile").val());
        if (mobile == "" || mobile.length == 0) {
            alert("请输入手机号");
            return;
        } else if (!mobile.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)) {
            alert('手机号输入有误！');
            return;
        }
        var nums = 60;
        btn.innerHTML = nums + ' 秒';
        $("#get_code").attr("disabled", true);
        $("#get_code").css("background-color", "#ccc");
        clock = setInterval(function () {
            nums--;
            if (nums > 0) {
                btn.innerHTML = nums + ' 秒';

            } else {
                clearInterval(clock);
                btn.innerHTML = '获取验证码';
                $("#get_code").attr("disabled", false);
                $("#get_code").css("background-color", "rgb(251, 76, 15)");
                nums = 60;
            }
        }, 1000);

        GetAsyncData("Wljw/1051", function (backdata) {
        }, {phoneNumber: mobile});
    }

    function submitForm(enterBtn) {
        window.location.href = config.activity.refuelingUrl + "&linkId=1060" + openId;
        return;

        if (!isFocus) {
            showCodeDialog();
            return;
        }
        var type = saveNumber;
        var name = $.trim($('#name').val());
        var mobile = $.trim($('#mobile').val());
        var plateNumber = $.trim($('#plateNumber0').val());
        var isNewCar = $('#isNewCar0').attr("checked") == "checked" ? 1 : 0;
        var code = $.trim($("#sendActiveCode").val());
        if (name.length == 0) {
            alert('请输入姓名');
            return;
        }
        if (!mobile.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)) {
            alert('手机号输入有误！');
            return;
        }
        if (isNewCar == 1) {
            plateNumber = "";
        } else {
            if (!plateNumber.match(/^[\u4e00-\u9fa5]{1}[A-Z_a-z]{1}[A-Z_a-z_0-9]{5}$/)) {
                alert('车牌号输入有误！');
                return;
            }
            if (!plateCheck(plateNumber.substring(0, 1))) {
                alert('车所在省不在投保范围！');
                return;
            }
        }

        if (!isCheckMobile) {
            if (code.length == 0) {
                alert("请输入验证码");
                return;
            } else {
                showCenterSpinner();
                GetAsyncData("Wljw/1052", function (backdata) {
                    hideCenterSpinner();
                    if (backdata.verifyFlag == '0') {
                        isCheckMobile = true;
                        save();
                        if (isNewCar == 1) {
                            plateNumber = "*-*";
                        }
                        var form = $('#infoForm');
                        var htmlStr = "<input type='text' value='" + name + "' name='vehicleOwnerName'/>"
                                + "<input type='number' value='" + mobile + "' name='vehicleOwnerMobile'/>"
                                + "<input type='text' value='" + plateNumber + "' name='licensePlateNo'/>"
                                + "<input type='text' value='" + "104" + type + openId + "' name='linkId'/>";
                        //alert("车牌：" + plateNumber);
                        form.append(htmlStr);
                        form.submit();
                    } else {
                        hideCenterSpinner();
                        alert('验证码不正确，请重新获取！');
                    }
                }, {"messageCode": code, "phoneNumber": mobile});


//                GetAsyncData("Transfer/1012", function (backdata) {
////                    hideCenterSpinner();
//                    var data = backdata.data;
//                    console.log("checkCode:" + data.resultCode);
//                    if (data.resultCode != "0000") {
//                        hideCenterSpinner();
//                        alert("验证码不正确，请重新获取！");
//                    } else {
//                        isCheckMobile = true;
//                        save();
//                        if (isNewCar == 1) {
//                            plateNumber = "*-*";
//                        }
//                        var form = $('#infoForm');
//                        var htmlStr = "<input type='text' value='" + name + "' name='vehicleOwnerName'/>"
//                                + "<input type='number' value='" + mobile + "' name='vehicleOwnerMobile'/>"
//                                + "<input type='text' value='" + plateNumber + "' name='licensePlateNo'/>"
//                                + "<input type='text' value='" + "104" + type + openId + "' name='linkId'/>";
//                        //alert("车牌：" + plateNumber);
//                        form.append(htmlStr);
//                        form.submit();
//                    }
//                }, {"checkCode": code, "uuid": uuid});
            }
        } else {
            save();
            if (isNewCar == 1) {
                plateNumber = "*-*";
            }
            var form = $('#infoForm');
            var htmlStr = "<input type='text' value='" + name + "' name='vehicleOwnerName'/>"
                    + "<input type='number' value='" + mobile + "' name='vehicleOwnerMobile'/>"
                    + "<input type='text' value='" + plateNumber + "' name='licensePlateNo'/>"
                    + "<input type='text' value='" + "104" + type + openId + "' name='linkId'/>";
//            alert("车牌：" + plateNumber);
            form.append(htmlStr);
            form.submit();
        }
    }

    function plateCheck(text) {
        var cars = new Array('辽', '京', '冀', '晋', '蒙', '吉', '黑', '苏', '浙', '皖', '闽', '鲁', '豫', '鄂', '桂', '川', '云', '陕', '甘', '新', '津', '沪', '湘', '粤', '渝');
        for (var i = 0; i < cars.length; i++) {
            if (text == cars[i]) {
                return true;
            }
        }
        return false;
    }

    function checkNewCar(ck) {
        var index = $(ck).attr('id').substring($(ck).attr('id').length - 1, $(ck).attr('id').length);
        var plateNumber = $.trim($('#plateNumber' + index).val());
        if ($(ck).attr('checked') == "checked") {
            $(ck).prev('img').attr('src', '../../../images/cars/unchecked.png');
            $(ck).removeAttr('checked');
            $('#plateNumber' + index).removeAttr("disabled");
            $('#plateNumber' + index).removeClass("disable");
            $('#plateNumber' + index).attr("disable");
            $('#plateNumber' + index).attr("placeholder", "请输入车牌号");
        } else {
            $(ck).prev('img').attr('src', '../../../images/cars/checked.png');
            $(ck).attr('checked', "checked");
            $('#plateNumber' + index).attr("placeholder", "");
            $('#plateNumber' + index).attr("disabled", "disabled");
            $('#plateNumber' + index).addClass("disable");
            $('#plateNumber' + index).val("");
        }
        judge();
    }

    function save() {

        var name = $.trim($('#name').val());
        var mobile = $.trim($('#mobile').val());
        var plateNumber = $.trim($('#plateNumber0').val());
        var isNewCar = $('#isNewCar0').attr("checked") == "checked" ? 1 : 0;
        var sData = {
            "openId": openId,
            "activityId": "104",
            "name": name,
            "phoneNumber": mobile,
            "type": saveNumber,
            "plateNumber": plateNumber,
            "isNew": isNewCar
        };

    }

    function inputBlur(ipt) {
        if ($(ipt).attr('id') == 'mobile') {
            if ($(ipt).val().length != 0)
                if (!$(ipt).val().match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)) {
//                    alert('手机号输入有误！');
                    //$(ipt).focus();
                }
        }
//        if ($(ipt).attr('id') == 'sendActiveCode') {
//            var code = $.trim($(ipt).val());
//            if (!isCheckMobile && uuid.length != 0 && code.length != 0) {
//                GetAsyncData("Transfer/1012", function (backdata) {
//                    var data = backdata.data;
//                    console.log("checkCode:" + data.resultCode);
//                    if (data.resultCode != "0000") {
//                        hideCenterSpinner();
//                        alert("验证码不正确，请重新获取！");
//                    } else {
//                        isCheckMobile = true;
//                    }
//                }, {"checkCode": code, "uuid": uuid});
//            }
//        }
        if ($(ipt).attr('id') == 'plateNumber1' || $(ipt).attr('id') == 'plateNumber2' || $(ipt).attr('id') == 'plateNumber0') {

            var index = $(ipt).attr('id').substring($(ipt).attr('id').length - 1, $(ipt).attr('id').length);
            var isNewCar = $('#isNewCar' + index).attr("checked") == "checked" ? 1 : 0;
            var plateNum = $.trim($(ipt).val());
            if (plateNum.length == 7) {
                plateNum = plateNum.toUpperCase();
                $(ipt).val(plateNum);
            }
            if (isNewCar != 1 && $.trim($(ipt).val()).length != 0) {
                if (!$.trim($(ipt).val()).match(/^[\u4e00-\u9fa5]{1}[A-Z_a-z]{1}[A-Z_a-z_0-9]{5}$/)) {
                    alert('车牌号输入有误！');
                    return;
                }
            }
        }

    }
</script>

</html>